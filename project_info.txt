# Project Informatie: aiontwikkelhulp

## Projectoverzicht
De AI Ontwikkelhulp (aiontwikkelhulp) is een tool die de communicatie tussen gebruikers en AI-modellen (specifiek Claude) faciliteert om code-ontwikkeling en repository-beheer te ondersteunen. De tool biedt een gestructureerde manier om AI-gestuurde ontwikkeling uit te voeren volgens een vooraf gedefinieerde werkwijze.

## Architectuur
De aiontwikkelhulp bestaat uit verschillende modules die samenwerken om gebruikers te helpen bij het ontwikkelen van software met behulp van AI:

### Core Modules:
- Flask web-applicatie (app.py)
- Anthropic API integratie (anthropic_api.py)
- MCP Connector voor tools integratie (mcp_connector.py)
- Configuratie (config.py)
- Repository beheer

### Nieuwe Modules (Refactoring):
- Anthropic configuratie (anthropic_config.py)
- Anthropic client (anthropic_client.py)
- Conversation manager (conversation_manager.py)
- MCP integratie (mcp_integration.py)

## Modules

### anthropic_api.py
- **Status**: Gerefactored met repository context caching
- **Pad**: /anthropic_api.py
- **Functionaliteit**: High-level API voor interactie met Anthropic Claude modellen. Coördineert tussen client, conversation management, en MCP integratie. Voegt automatisch repository context toe aan system prompts.
- **Afhankelijkheden**: anthropic_config.py, anthropic_client.py, conversation_manager.py, mcp_integration.py, repositories

### anthropic_config.py
- **Status**: Nieuw toegevoegd
- **Pad**: /anthropic_config.py
- **Functionaliteit**: Centralized Anthropic-specifieke configuratie met lazy loading en validatie.
- **Afhankelijkheden**: Geen directe afhankelijkheden

### anthropic_client.py
- **Status**: Nieuw toegevoegd
- **Pad**: /anthropic_client.py
- **Functionaliteit**: Pure API communicatie met Claude modellen, gescheiden van business logic.
- **Afhankelijkheden**: anthropic_config.py

### conversation_manager.py
- **Status**: Uitgebreid met repository context caching
- **Pad**: /conversation_manager.py
- **Functionaliteit**: Beheert conversatie staat en geschiedenis, ondersteunt storage backends. Nieuwe functionaliteit voor het cachen van repository contexts per conversatie.
- **Afhankelijkheden**: repositories (optioneel voor database storage)

### mcp_integration.py
- **Status**: Uitgebreid met repository context ophalen
- **Pad**: /mcp_integration.py
- **Functionaliteit**: Beheert MCP server connecties en tool gebruik. Haalt automatisch project_structure.md op uit repositories en cachet deze per conversatie.
- **Afhankelijkheden**: mcp_connector.py, anthropic_config.py, conversation_manager.py (optioneel)

### config.py
- **Status**: Gerefactored
- **Pad**: /config.py
- **Functionaliteit**: Verzorgt de algemene applicatie configuratie. Anthropic-specifieke config is verplaatst naar anthropic_config.py.
- **Afhankelijkheden**: anthropic_config.py

### mcp_connector.py
- **Status**: Actief
- **Pad**: /mcp_connector.py
- **Functionaliteit**: Zorgt voor communicatie met externe tools die AI kan gebruiken.
- **Afhankelijkheden**: Geen directe afhankelijkheden binnen het project

### app.py
- **Status**: Actief
- **Pad**: /app.py
- **Functionaliteit**: Flask web-applicatie die de gebruikersinterface biedt.
- **Afhankelijkheden**: anthropic_api.py, config.py

### werkwijze/werkwijze.txt
- **Status**: Actief
- **Pad**: /werkwijze/werkwijze.txt
- **Functionaliteit**: Bevat instructies voor het AI-model over hoe repository-ontwikkeling moet verlopen.
- **Afhankelijkheden**: Wordt gebruikt door anthropic_config.py (lazy loaded)

### system_prompt.txt
- **Status**: Actief
- **Pad**: /system_prompt.txt
- **Functionaliteit**: Bevat de basis system prompt voor het AI-model.
- **Afhankelijkheden**: Wordt gebruikt door anthropic_config.py (lazy loaded)

### tests/test_anthropic_config.py
- **Status**: Nieuw toegevoegd
- **Pad**: /tests/test_anthropic_config.py
- **Functionaliteit**: Unit tests voor AnthropicConfig module.
- **Afhankelijkheden**: anthropic_config.py

### tests/test_conversation_manager.py
- **Status**: Nieuw toegevoegd
- **Pad**: /tests/test_conversation_manager.py
- **Functionaliteit**: Unit tests voor ConversationManager module.
- **Afhankelijkheden**: conversation_manager.py

## Recente Wijzigingen

### Repository Context Caching (Issue #33)
- **Automatische detectie**: Wanneer een GitHub repository wordt genoemd, controleert het systeem automatisch of project_structure.md bestaat
- **Eenmalig ophalen**: Het bestand wordt maximaal één keer per repository per conversatie opgehaald
- **Context toevoeging**: De inhoud wordt automatisch toegevoegd aan het system prompt voor alle volgende berichten
- **Logging**: Duidelijke log berichten wanneer een bestand wordt gevonden, gecached, of niet bestaat
- **Performance**: Geen onnodige API calls naar GitHub dankzij conversatie-niveau caching

### Refactoring van config.py en anthropic_api.py (Issue #30)
- **Configuratie Management**: Implementatie van lazy loading voor configuratiebestanden, centralisatie van Anthropic configuratie in aparte module
- **Code Duplicatie**: Verwijdering van dubbele configuratie logic, consolidatie van API key validatie
- **Architectuur Verbetering**: Splitsing van AnthropicAPI in kleinere, gefocuste componenten met duidelijke verantwoordelijkheden
- **Backwards Compatibility**: Behoud van bestaande interfaces voor minimale impact op bestaande code
- **Testing**: Toevoeging van unit tests voor nieuwe modules